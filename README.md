# pNetwork monorepo

<a alt="Nx logo" href="https://nx.dev" target="_blank" rel="noreferrer"><img src="https://raw.githubusercontent.com/nrwl/nx/master/images/nx-logo.png" width="45"></a>

✨ **This workspace has been generated by [Nx, a Smart, fast and extensible build system.](https://nx.dev)** ✨

- [Basic tutorial](#basic-tutorial)
  - [Install `Nx`](#basic-install)
  - [Add a new project:](#basic-new-proj)
  - [Add a new local dependency](#basic-local-dep)
  - [Test all projects](#basic-test-all)
  - [Test a single project](#basic-test-sigle)
  - [Lint a single project](#basic-lint-single)
- [Best practices](#best-practices)
  - [Linting](#best-practices-linting)
  - [Commits](#best-practices-commits)
  - [Development process](#best-practices-dev-process)

## <a name="basic-tutorial"></a> Basic tutorial

### <a name="basic-install"></a> Install `Nx`

```bash
npm install -g nx
```

### <a name="basic-new-proj"></a> Add a new project:

To add/remove a project, just add/remove the folder to `packages/` and then, at the root:

```bash
npm install
```

### <a name="basic-local-dep"></a> Add a new local dependency

Add the dependency in the package's `package.json` file:

```
"dependencies": {
    "ptokens-utils": "*",
}
```

Then, at the project's root:

```bash
npm install
```

### <a name="basic-test-all"></a> Test all projects

```bash
nx run-many --target=test
```

### <a name="basic-test-sigle"></a> Test a single project

```bash
nx run ptokens-btc-syncer:test
```

### <a name="basic-lint-single"></a> Lint a single project

```bash
nx lint ptokens-utils
```

**Note:** Every script in the project should be run as a Nx task in
order to work properly, as module dependencies are installed in the
monorepo's root, not in the project anymore.

## <a name="best-practices"></a> Best practices

### <a name="best-practices-linting"></a> Linting

For JS source code, linting is governed by Google [`gts`](https://github.com/google/gts).
Just add the following JSON to a new project:

```json
{
  "extends": ["../../.eslintrc.json"]
}
```

If you need a new rule to add, please ask the team's opinion about it first in order to
select the best option for everyone.

### <a name="best-practices-commits"></a> Commits

Please follow the [`Convertional commit standard`](https://www.conventionalcommits.org/en/v1.0.0/)
when committing to any project in this repo, with this rule on top of that:

```
commit-type(<project-name>): <commit-text> [(<file|folder|context>)]
```

#### Examples

```
feat(ptokens-utils): add superpowers (fly.js)
refactor(ptokens-listener): rename this into that
```

**Note:** `[(<file|folder|context>)]` can be used when applicable,
on a set of files it's better omitting it.

### <a name="best-practices-dev-process"></a> Development process

Create a new branch having the pattern

```
<feat|chore|refactor|fix>/<component-name>/<branch-name>
```

#### Examples

- feat/ptokens-utils/add-superpowers
- chore/ptokens-listener/rename-file
- fix/ptokens-schemas/wrong-type
